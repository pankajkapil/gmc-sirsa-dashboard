<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width">
  <title>GMC Sirsa - Admin</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial; background: #f0f0f0; }
    .admin-panel { max-width: 1200px; margin: 20px auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 0 20px rgba(0,0,0,0.1); }
    h1, h2 { color: #333; margin-bottom: 20px; }
    .logout-btn { float: right; padding: 10px 20px; background: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer; }
    .form-group { margin-bottom: 20px; }
    .form-group label { display: block; margin-bottom: 5px; font-weight: bold; }
    .form-group input, .form-group select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-family: Arial; }
    .save-btn { padding: 12px 30px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; width: 100%; margin-top: 10px; }
    .save-btn:hover { background: #218838; }
    .section { background: #f9f9f9; padding: 20px; margin-bottom: 20px; border-left: 4px solid #007bff; border-radius: 4px; }
    #login-page { display: block; }
    #admin-page { display: none; }
    .two-col { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
    .photo-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
    .photo-item { border: 1px solid #ddd; padding: 15px; border-radius: 4px; background: #f5f5f5; }
    .photo-item label { font-size: 14px; font-weight: bold; color: #555; margin-bottom: 10px; }
    .photo-item input[type="file"] { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
    .status-msg { margin-top: 10px; padding: 10px; border-radius: 4px; font-weight: bold; display: none; }
    .status-success { background: #d4edda; color: #155724; }
  </style>
</head>
<body>
  <div class="admin-panel">
    <div id="login-page">
      <h1>Admin Login</h1>
      <div class="form-group">
        <label>Password:</label>
        <input type="password" id="password" placeholder="Enter password">
      </div>
      <button class="save-btn" onclick="login()">Login</button>
    </div>
    <div id="admin-page">
      <h1>Admin Dashboard <button class="logout-btn" onclick="logout()">Logout</button></h1>
      <div id="status-message" class="status-msg"></div>
      
      <div class="section">
        <h2>Project KPIs</h2>
        <div class="two-col">
          <div class="form-group">
            <label>Physical Progress (%):</label>
            <input type="number" id="physicalProgress" min="0" max="100">
          </div>
          <div class="form-group">
            <label>Financial Progress (%):</label>
            <input type="number" id="financialProgress" min="0" max="100">
          </div>
        </div>
        <div class="two-col">
          <div class="form-group">
            <label>Total Project Cost (Cr):</label>
            <input type="number" id="totalProjectCost" step="0.01">
          </div>
          <div class="form-group">
            <label>Funds Released (Cr):</label>
            <input type="number" id="totalFundsReleased" step="0.01">
          </div>
        </div>
        <div class="two-col">
          <div class="form-group">
            <label>Financial Progress Amount (Cr):</label>
            <input type="number" id="financialProgressAmount" step="0.01">
          </div>
          <div class="form-group">
            <label>Funding Gap (Cr):</label>
            <input type="number" id="fundingGap" step="0.01">
          </div>
        </div>
      </div>
      
      <div class="section">
        <h2>RAG Status</h2>
        <div class="two-col">
          <div class="form-group">
            <label>Quality:</label>
            <select id="qualityStatus"><option>GREEN</option><option>AMBER</option><option>RED</option></select>
          </div>
          <div class="form-group">
            <label>Timeline:</label>
            <select id="timelineStatus"><option>GREEN</option><option>AMBER</option><option>RED</option></select>
          </div>
        </div>
        <div class="two-col">
          <div class="form-group">
            <label>Cost:</label>
            <select id="costStatus"><option>GREEN</option><option>AMBER</option><option>RED</option></select>
          </div>
          <div class="form-group">
            <label>Safety:</label>
            <select id="safetyStatus"><option>GREEN</option><option>AMBER</option><option>RED</option></select>
          </div>
        </div>
      </div>
      
      <div class="section">
        <h2>Building Progress</h2>
        <div id="buildingsContainer"></div>
      </div>

      <div class="section">
        <h2>Monthly Progress Photos (Nov 2025 - Oct 2026)</h2>
        <div class="photo-grid" id="photosContainer"></div>
      </div>
      
      <button class="save-btn" onclick="saveData()">Save Data & Sync to All Devices</button>
    </div>
  </div>

  <script>
    const adminPassword = "admin123";
    const buildings = [
      "External Development/Road",
      "Junior & Senior Resident",
      "Boys Hostel (G+8)",
      "Nursing Girls Hostel (G+8)",
      "Girls Hostel (G+6)",
      "Hospital Block (B+G+7)",
      "Service Block",
      "Vishram Sarai (G+2)",
      "Medical College (B+G+5)",
      "Director & MS Residence",
      "Paramedical Block (B+G+6)",
      "Common Basement"
    ];

    const months = [
      "November 2025", "December 2025", "January 2026", "February 2026",
      "March 2026", "April 2026", "May 2026", "June 2026",
      "July 2026", "August 2026", "September 2026", "October 2026"
    ];

    function login() {
      const pwd = document.getElementById('password').value;
      if (pwd === adminPassword) {
        localStorage.setItem('adminLoggedIn', 'true');
        document.getElementById('login-page').style.display = 'none';
        document.getElementById('admin-page').style.display = 'block';
        renderBuildings();
        renderPhotoUpload();
        loadData();
      } else {
        alert('Invalid password');
      }
    }

    function logout() {
      localStorage.removeItem('adminLoggedIn');
      document.getElementById('login-page').style.display = 'block';
      document.getElementById('admin-page').style.display = 'none';
      document.getElementById('password').value = '';
    }

    function renderBuildings() {
      const container = document.getElementById('buildingsContainer');
      container.innerHTML = '';
      const grid = document.createElement('div');
      grid.className = 'two-col';
      
      buildings.forEach(building => {
        const div = document.createElement('div');
        div.className = 'form-group';
        div.innerHTML = `<label>${building} (%):</label><input type="number" id="building_${building}" min="0" max="100">`;
        grid.appendChild(div);
      });
      container.appendChild(grid);
    }

    function renderPhotoUpload() {
      const container = document.getElementById('photosContainer');
      container.innerHTML = '';
      months.forEach((month, index) => {
        const div = document.createElement('div');
        div.className = 'photo-item';
        div.innerHTML = `<label>${month}</label><input type="file" id="photo_${index}" accept="image/*">`;
        container.appendChild(div);
      });
    }

    function saveData() {
      const data = {
        physicalProgress: parseInt(document.getElementById('physicalProgress').value) || 0,
        financialProgress: parseInt(document.getElementById('financialProgress').value) || 0,
        totalProjectCost: document.getElementById('totalProjectCost').value || "0",
        totalFundsReleased: document.getElementById('totalFundsReleased').value || "0",
        financialProgressAmount: document.getElementById('financialProgressAmount').value || "0",
        fundingGap: document.getElementById('fundingGap').value || "0",
        ragStatus: {
          quality: document.getElementById('qualityStatus').value,
          timeline: document.getElementById('timelineStatus').value,
          cost: document.getElementById('costStatus').value,
          safety: document.getElementById('safetyStatus').value
        },
        timestamp: new Date().toISOString(),
        lastUpdated: new Date().toISOString().split('T')[0]
      };

      buildings.forEach(building => {
        data[`building_${building}`] = parseInt(document.getElementById(`building_${building}`).value) || 0;
      });

      localStorage.setItem('projectData', JSON.stringify(data));
      showMessage('Data saved to all devices!');
    }

    function loadData() {
      const data = JSON.parse(localStorage.getItem('projectData') || '{}');
      if (Object.keys(data).length > 0) {
        document.getElementById('physicalProgress').value = data.physicalProgress || 0;
        document.getElementById('financialProgress').value = data.financialProgress || 0;
        document.getElementById('totalProjectCost').value = data.totalProjectCost || "";
        document.getElementById('totalFundsReleased').value = data.totalFundsReleased || "";
        document.getElementById('financialProgressAmount').value = data.financialProgressAmount || "";
        document.getElementById('fundingGap').value = data.fundingGap || "";
        
        if (data.ragStatus) {
          document.getElementById('qualityStatus').value = data.ragStatus.quality || 'GREEN';
          document.getElementById('timelineStatus').value = data.ragStatus.timeline || 'GREEN';
          document.getElementById('costStatus').value = data.ragStatus.cost || 'GREEN';
          document.getElementById('safetyStatus').value = data.ragStatus.safety || 'GREEN';
        }
        
        buildings.forEach(building => {
          const el = document.getElementById(`building_${building}`);
          if (el) el.value = data[`building_${building}`] || 0;
        });
      }
    }

    function showMessage(msg) {
      const msgEl = document.getElementById('status-message');
      msgEl.textContent = msg;
      msgEl.className = 'status-msg status-success';
      msgEl.style.display = 'block';
      setTimeout(() => { msgEl.style.display = 'none'; }, 3000);
    }

    window.addEventListener('load', () => {
      if (localStorage.getItem('adminLoggedIn') === 'true') {
        document.getElementById('login-page').style.display = 'none';
        document.getElementById('admin-page').style.display = 'block';
        renderBuildings();
        renderPhotoUpload();
        loadData();
      }
    });
  </script>
</body>
</html>
